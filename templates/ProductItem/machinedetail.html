{% extends 'Pages/base.html' %}
{% load static %}
{% block title %}Machine Detail{% endblock title %}

{% block body %}
<section>
  <!-- Machinery Detail Section -->
  <div class="container my-5">
    <div class="row">
      <!-- Image Section -->
      <div class="col-lg-6 col-md-12 text-center">
        <img src="{{mproduct.product_image.url}}" alt="{{mproduct.title}}" class="img-fluid rounded-3 shadow-sm">
      </div>

      <!-- Product Information Section -->
      <div class="col-lg-6 col-md-12 mt-4 mt-lg-0">
        <h2 class="fw-bold">{{mproduct.title}}</h2>
        <hr>
        <p class="text-muted">{{mproduct.description}}</p>
        <h4 class="text-primary mt-3">TK. {{mproduct.rent_perday}} per day</h4>

        <!-- User Actions -->
        {% if user.is_authenticated %}
        <div class="mt-4">
          <button class="btn btn-lg btn-primary w-100" data-toggle="modal" data-target="#getcar">
            <i class="fas fa-phone-alt"></i> Contact For Rent
          </button>
        </div>
        {% else %}
        <div class="mt-4">
          <a href="{% url 'login' %}" class="btn btn-warning btn-lg w-100">
             Login Please
          </a>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</section>

<!-- Contact Modal -->
<div class="modal fade" id="getcar" tabindex="-1" aria-labelledby="getcarLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="getcarLabel">Contacting Krishi Sheba</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form action="{% url 'machinery_contact' %}" method="POST">
          {% csrf_token %}
          {% if user.is_authenticated %}
            <input type="hidden" name="user_id" value="{{ user.id }}">
          {% else %}
            <input type="hidden" name="user_id" value="0">
          {% endif %}
          <input type="hidden" name="product_id" value="{{ mproduct.id }}">
          <h4 class="text-center text-primary fw-bold">Welcome to Krishi Sheba</h4>

          <div class="form-group">
            <label for="machine-name" class="col-form-label">Machinery Name:</label>
            <input type="text" name="mproduct" class="form-control" value="{{ mproduct.title }}" readonly>
          </div>
          <div class="form-group">
            <label for="name" class="col-form-label">Your Name:</label>
            <input type="text" name="name" class="form-control" {% if user.is_authenticated %} value="{{ user.username }}" {% endif %} required>
          </div>
          <div class="form-group">
            <label for="email" class="col-form-label">Your Email:</label>
            <input type="email" name="email" class="form-control" {% if user.is_authenticated %} value="{{ user.email }}" {% endif %} required>
          </div>
          <div class="form-group">
            <label for="phone" class="col-form-label">Phone:</label>
            <input type="text" name="phone" class="form-control" required>
          </div>
          <div class="form-group">
            <label for="message" class="col-form-label">Message:</label>
            <textarea name="message" class="form-control" rows="4" required></textarea>
          </div>
          <hr>
          <button type="submit" class="btn btn-block btn-primary">Send Message</button>
        </form>
      </div>
    </div>
  </div>
</div>

{% endblock body %}

<!-- Additional Styling and Customizations -->
<style>
  /* Card and Image Styling */
  .img-fluid {
    max-height: 350px;
    object-fit: cover;
    border-radius: 15px;
  }

  /* Button Enhancements */
  .btn-primary, .btn-warning {
    font-size: 16px;
    font-weight: 600;
    border-radius: 30px;
  }

  .btn-primary:hover, .btn-warning:hover {
    opacity: 0.9;
  }

  /* Modal Styling */
  .modal-content {
    border-radius: 15px;
  }

  .modal-header {
    background-color: #007bff;
    color: #fff;
  }

  /* Product Info Section */
  h2, h4, h5 {
    color: #333;
  }

  .text-primary {
    color: #007bff !important;
  }

  /* Modal and Form Styling */
  .modal-body .form-group {
    margin-bottom: 20px;
  }

  .form-control {
    border-radius: 20px;
    padding: 10px;
  }

  .form-control:focus {
    border-color: #007bff;
    box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
  }

  /* Responsive Adjustments */
  @media (max-width: 767px) {
    .img-fluid {
      max-height: 300px;
    }

    .modal-dialog {
      max-width: 90%;
    }
  }
</style>
